// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: get_employee_reviews.sql

package peopledb

import (
	"context"

	"github.com/jackc/pgx/v5/pgtype"
)

const getEmployeeReviews = `-- name: GetEmployeeReviews :many
SELECT
    r.id, r.tenant_id, r.employee_id, r.reviewer_id, r.cycle_id, r.status, r.review_type, r.overall_rating, r.strengths, r.areas_for_improvement, r.manager_comments, r.submitted_at, r.acknowledged_at, r.created_at, r.updated_at,
    c.name as cycle_name,
    e.first_name as reviewer_first_name,
    e.last_name as reviewer_last_name
FROM
    performance_reviews r
    LEFT JOIN review_cycles c ON r.cycle_id = c.id
    LEFT JOIN employees e ON r.reviewer_id = e.id
WHERE
    r.employee_id = $1
ORDER BY r.created_at DESC
`

type GetEmployeeReviewsRow struct {
	ID                  int32              `json:"id"`
	TenantID            int32              `json:"tenant_id"`
	EmployeeID          int32              `json:"employee_id"`
	ReviewerID          pgtype.Int4        `json:"reviewer_id"`
	CycleID             pgtype.Int4        `json:"cycle_id"`
	Status              pgtype.Text        `json:"status"`
	ReviewType          pgtype.Text        `json:"review_type"`
	OverallRating       pgtype.Text        `json:"overall_rating"`
	Strengths           pgtype.Text        `json:"strengths"`
	AreasForImprovement pgtype.Text        `json:"areas_for_improvement"`
	ManagerComments     pgtype.Text        `json:"manager_comments"`
	SubmittedAt         pgtype.Timestamptz `json:"submitted_at"`
	AcknowledgedAt      pgtype.Timestamptz `json:"acknowledged_at"`
	CreatedAt           pgtype.Timestamptz `json:"created_at"`
	UpdatedAt           pgtype.Timestamptz `json:"updated_at"`
	CycleName           pgtype.Text        `json:"cycle_name"`
	ReviewerFirstName   pgtype.Text        `json:"reviewer_first_name"`
	ReviewerLastName    pgtype.Text        `json:"reviewer_last_name"`
}

func (q *Queries) GetEmployeeReviews(ctx context.Context, employeeID int32) ([]GetEmployeeReviewsRow, error) {
	rows, err := q.db.Query(ctx, getEmployeeReviews, employeeID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []GetEmployeeReviewsRow
	for rows.Next() {
		var i GetEmployeeReviewsRow
		if err := rows.Scan(
			&i.ID,
			&i.TenantID,
			&i.EmployeeID,
			&i.ReviewerID,
			&i.CycleID,
			&i.Status,
			&i.ReviewType,
			&i.OverallRating,
			&i.Strengths,
			&i.AreasForImprovement,
			&i.ManagerComments,
			&i.SubmittedAt,
			&i.AcknowledgedAt,
			&i.CreatedAt,
			&i.UpdatedAt,
			&i.CycleName,
			&i.ReviewerFirstName,
			&i.ReviewerLastName,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}
