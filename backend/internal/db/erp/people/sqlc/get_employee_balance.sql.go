// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: get_employee_balance.sql

package peopledb

import (
	"context"

	"github.com/jackc/pgx/v5/pgtype"
)

const getEmployeeBalance = `-- name: GetEmployeeBalance :many
SELECT b.id, b.employee_id, b.year, b.balance, p.name as policy_name, p.leave_type
FROM
    time_off_balances b
    JOIN time_off_policies p ON b.policy_id = p.id
WHERE
    b.employee_id = $1
    AND b.year = $2
`

type GetEmployeeBalanceParams struct {
	EmployeeID int32 `json:"employee_id"`
	Year       int32 `json:"year"`
}

type GetEmployeeBalanceRow struct {
	ID         int32          `json:"id"`
	EmployeeID int32          `json:"employee_id"`
	Year       int32          `json:"year"`
	Balance    pgtype.Numeric `json:"balance"`
	PolicyName string         `json:"policy_name"`
	LeaveType  string         `json:"leave_type"`
}

func (q *Queries) GetEmployeeBalance(ctx context.Context, arg GetEmployeeBalanceParams) ([]GetEmployeeBalanceRow, error) {
	rows, err := q.db.Query(ctx, getEmployeeBalance, arg.EmployeeID, arg.Year)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []GetEmployeeBalanceRow
	for rows.Next() {
		var i GetEmployeeBalanceRow
		if err := rows.Scan(
			&i.ID,
			&i.EmployeeID,
			&i.Year,
			&i.Balance,
			&i.PolicyName,
			&i.LeaveType,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}
